<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Release Delivery Portal</title>
<style>
body {
  background:#0b0b0b;
  color:white;
  font-family:Arial, sans-serif;
  margin:0;
  padding:30px 15px;
}

.container {
  max-width:650px;
  margin:auto;
  background:#151515;
  padding:35px 25px;
  border-radius:16px;
  box-shadow:0 0 40px rgba(0,0,0,0.6);
}

h1 {
  text-align: center;
  margin-bottom: 25px;
  font-size: 24px;
  font-weight: 600;
  letter-spacing: 1.5px;
  color: #f2f2f2;
  }

label {
  display:block;
  margin-top:18px;
  margin-bottom:6px;
  font-size:14px;
  color:#ccc;
}

input, select {
  width:100%;
  padding:14px;
  border-radius:10px;
  border:none;
  background:#222;
  color:white;
  font-size:14px;
}

.track {
  background:#1c1c1c;
  padding:18px;
  border-radius:12px;
  margin-top:20px;
}

button {
  width:100%;
  padding:16px;
  margin-top:25px;
  border-radius:12px;
  border:none;
  background:#00ff99;
  color:black;
  font-weight:bold;
  font-size:15px;
  cursor:pointer;
}

button:hover {
  background:#00cc77;
}

.progressBar {
  height:6px;
  background:#333;
  margin-top:10px;
  border-radius:6px;
}

.progressFill {
  height:100%;
  width:0%;
  background:#00ff99;
  border-radius:6px;
}

img {
  margin-top:15px;
  border-radius:12px;
  max-height:280px;
  object-fit:cover;
}
</style>
</head>
<body>

<div class="container">
<h1>Release Upload</h1>

<form id="releaseForm">

<label>Release Type</label>
<select id="releaseType" required>
  <option value="">Select</option>
  <option value="Single">Single</option>
  <option value="EP">EP</option>
  <option value="Album">Album</option>
</select>

<div id="tracksContainer"></div>
<label>Cover Artwork (3000x3000)</label>
<input type="file" id="coverArt" required>

<button type="button" id="addTrackBtn" onclick="addTrack()">+ Add Another Track</button>

<div id="previewArea"></div>

<button type="submit" id="submitBtn">Send Release ðŸš€</button>

</form>
</div>

<script>
const CLOUD_NAME = "djpeitfan";
const UPLOAD_PRESET = "label_upload";
let trackCount = 0;
let uploadedLinks = "";

function addTrack() {
  trackCount++;
  const div = document.createElement('div');
  div.className = "track";
  div.innerHTML = `
    <label>Track Title</label>
    <input type="text" required>

    <label>Version Name (optional)</label>
    <input type="text">

    <label>Audio File</label>
    <input type="file" class="audioFile" required>
  `;
  document.getElementById('tracksContainer').appendChild(div);
}

document.getElementById("releaseForm").addEventListener("submit", async e => {
  e.preventDefault();

  const btn = document.getElementById("submitBtn");
  btn.disabled = true;
  btn.innerText = "Uploading...";

  let uploadedLinks = "";

  const audioInputs = document.querySelectorAll(".audioFile");

  for (let input of audioInputs) {

    if (!input.files || !input.files[0]) {
      alert("Audio file missing!");
      btn.disabled = false;
      btn.innerText = "Send Release ðŸš€";
      return;
    }

    const file = input.files[0];
    const url = await uploadFile(file, input.parentElement, false);

    if (!url) {
      alert("Audio upload failed!");
      btn.disabled = false;
      btn.innerText = "Send Release ðŸš€";
      return;
    }

    uploadedLinks += url + "\n";
  }

  const coverInput = document.getElementById("coverArt");

  if (!coverInput.files || !coverInput.files[0]) {
    alert("Cover art missing!");
    btn.disabled = false;
    btn.innerText = "Send Release ðŸš€";
    return;
  }

  const coverUrl = await uploadFile(coverInput.files[0], coverInput.parentElement, true);

  if (!coverUrl) {
    alert("Cover upload failed!");
    btn.disabled = false;
    btn.innerText = "Send Release ðŸš€";
    return;
  }

  const data = new FormData();
  data.append("file_links", uploadedLinks.trim());
  data.append("cover_art", coverUrl);
  data.append("release_type", document.getElementById("releaseType").value);

  await fetch("https://formspree.io/f/mzzrkpqj", {
    method: "POST",
    body: data
  });

  btn.innerText = "Submitted âœ…";
  btn.disabled = false;
});
</script>

</body>
</html>
