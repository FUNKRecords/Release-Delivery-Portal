<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Release Delivery Portal</title>
<style>
body {background:#0b0b0b;color:white;font-family:Arial;margin:0;padding:20px;}
.container {max-width:800px;margin:auto;background:#151515;padding:30px;border-radius:12px;}
h1 {text-align:center;}
input, select, button {
  width:100%;padding:12px;margin-top:10px;border-radius:8px;border:none;
}
input {background:#222;color:white;}
button {background:#00ff99;color:black;font-weight:bold;cursor:pointer;}
.track {border:1px solid #333;padding:15px;margin-top:15px;border-radius:10px;}
</style>
</head>
<body>

<div class="container">
<h1>Release Upload</h1>

<form action="https://formspree.io/f/YOURCODE" method="POST" enctype="multipart/form-data">

<label>Release Type</label>
<select id="releaseType" name="release_type" required>
  <option value="">Select</option>
  <option value="Single">Single</option>
  <option value="EP">EP</option>
  <option value="Album">Album</option>
</select>

<div id="tracksContainer"></div>

<label>Cover Artwork (3000x3000)</label>
<input type="file" name="cover_art" required>

<button type="button" onclick="addTrack()">+ Add Another Track</button>
<button type="submit">Submit Release</button>

</form>
</div>

<script>
let trackCount = 0;

function addTrack() {
  trackCount++;
  const container = document.getElementById('tracksContainer');
  const div = document.createElement('div');
  div.className = "track";
  div.innerHTML = `
    <label>Track Title</label>
    <input type="text" name="track_title_${trackCount}" required>

    <label>Version Name (Original, Slowed, Remix, etc.)</label>
    <input type="text" name="version_${trackCount}">

    <label>Audio File</label>
    <input type="file" name="audio_${trackCount}" required>
  `;
  container.appendChild(div);
}

document.getElementById('releaseType').addEventListener('change', function() {
  const container = document.getElementById('tracksContainer');
  container.innerHTML = "";
  trackCount = 0;

  if (this.value === "Single") {
    addTrack();
    document.querySelector('button[onclick="addTrack()"]').style.display = "none";
  } else {
    addTrack();
    document.querySelector('button[onclick="addTrack()"]').style.display = "block";
  }
});
</script>
  <script>
const CLOUD_NAME = "yourcloudname";
const UPLOAD_PRESET = "yourpreset";

function createProgressBar(container) {
  const bar = document.createElement("div");
  bar.style.height = "8px";
  bar.style.background = "#333";
  bar.style.marginTop = "8px";
  bar.style.borderRadius = "4px";

  const progress = document.createElement("div");
  progress.style.height = "100%";
  progress.style.width = "0%";
  progress.style.background = "#00ff99";
  progress.style.borderRadius = "4px";

  bar.appendChild(progress);
  container.appendChild(bar);
  return progress;
}

function uploadFile(file, container, preview=false) {
  return new Promise((resolve, reject) => {
    const xhr = new XMLHttpRequest();
    const url = `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/auto/upload`;

    const formData = new FormData();
    formData.append("file", file);
    formData.append("upload_preset", UPLOAD_PRESET);

    const progressBar = createProgressBar(container);

    xhr.upload.onprogress = e => {
      if (e.lengthComputable) {
        progressBar.style.width = (e.loaded / e.total * 100) + "%";
      }
    };

    xhr.onload = () => {
      const res = JSON.parse(xhr.responseText);
      if (preview) {
        const img = document.createElement("img");
        img.src = res.secure_url;
        img.style.width = "100%";
        img.style.marginTop = "10px";
        container.appendChild(img);
      }
      resolve(res.secure_url);
    };

    xhr.open("POST", url, true);
    xhr.send(formData);
  });
}

document.querySelector("form").addEventListener("submit", async function(e) {
  e.preventDefault();

  const submitBtn = e.target.querySelector("button[type='submit']");
  submitBtn.disabled = true;
  submitBtn.innerText = "Uploading...";

  let links = "";

  const fileInputs = document.querySelectorAll("input[type='file']");

  for (let input of fileInputs) {
    const container = input.parentElement;

    for (let file of input.files) {
      const size = (file.size / 1024 / 1024).toFixed(2);
      const info = document.createElement("div");
      info.innerText = `Uploading (${size} MB)...`;
      container.appendChild(info);

      const isArtwork = input.name.includes("cover");
      const url = await uploadFile(file, container, isArtwork);
      links += url + "\n";

      input.value = ""; // ⭐ prevents re-upload
    }
  }

  const emailData = new FormData();
  emailData.append("file_links", links);
  emailData.append("release_type", document.getElementById("releaseType").value);

  await fetch("https://formspree.io/f/YOURCODE", {
    method: "POST",
    body: emailData
  });

  submitBtn.innerText = "Upload Complete ✅";
});
  </script>

</body>
</html>
